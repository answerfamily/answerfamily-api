type Query {
  # List all paragraphs that meet the filter
  paragraphs(
    filter: ParagraphSearchFilter
    sort: [ParagraphSearchSort]
    first: Int
    skip: Int
  ): [Paragraph]

  # List all paragraphReplies
  paragraphReplies(
    first: Int
    skip: Int
  ): [ParagraphReply]

  # Get single aritcle
  article(id: String!): Article

  # Get single paragraph
  paragraph(id: String!): Paragraph

  # Get single reply
  reply(id: String!): Reply

  # Get currently logged-in user. null if not logged in.
  me: CurrentUser
}

"""
Actual article text being circulated.
May be LINE messages, text from flyers, etc.
"""
type Article {
  id: String
  text: String
  paragraphs: [Paragraph]
}

"""
Replied paragraph from an article
"""
type Paragraph {
  id: String
  text: String
  createdAt: String
  article: Article
  paragraphReplies: [ParagraphReply]
  user: User
}

"""
Connection between paragraphs and replies.
One paragraph may have multiple replies, and a reply can be used in multiple paragraphs.
"""
type ParagraphReply {
  id: ObjectId
  paragraph: Paragraph
  reply: Reply
  user: User
}

"""
Reply to a paragraph
"""
type Reply {
  id: String
  text: String
  reference: String

  # author's note, for other editors to see
  note: String

  paragraphReplies: [ParagraphReply]
}

"""
User object from Auth0 JWT
"""
type CurrentUser {
  # openid sub claim; user_id on auth0
  id: String
  picture: String
  name: String
  email: String
}

"""
Publuc user profile from auth0
"""
type User {
  # user in DB
  id: String
  picture: String
  name: String
}

input ParagraphSearchFilter {
  # matches only paragraphs that is inside the given text
  inText: String,

  # matches only paragraphs that contains these terms
  contain: String,
}

"""
Sort order for search results
"""
enum SortOrder {
  DESC
  ASC
}

enum ParagraphSearchSortBy {
  createdAt

  # Search result relevance
  _score
}

input ParagraphSearchSort {
  by: ParagraphSearchSortBy!
  order: SortOrder
}

"""
This scalar uses MongoDB object ID on server side
and coerce to string on client slide.
"""
scalar ObjectId
